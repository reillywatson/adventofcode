package main

import (
	"bytes"
	"fmt"
)

func main() {
	rows := bytes.Split([]byte(input), []byte{'\n'})
	fmt.Println(runParticle(rows, bytes.IndexByte(rows[0], 'S'), 0))
}

var cache = map[int]int{}

func runParticle(rows [][]byte, x, y int) int {
	if cached, ok := cache[y*len(rows)+x]; ok {
		return cached
	}
	var result int
	if y >= len(rows) {
		result = 1
	} else if rows[y][x] == '^' {
		result = runParticle(rows, x-1, y+1) + runParticle(rows, x+1, y+1)
	} else {
		result = runParticle(rows, x, y+1)
	}
	cache[y*len(rows)+x] = result
	return result
}

func main_partone() {
	timesSplit := 0
	rows := bytes.Split([]byte(input), []byte{'\n'})
	for rowNum, row := range rows {
		for col, c := range row {
			switch c {
			case '^':
				if rowNum > 0 && rows[rowNum-1][col] == '|' {
					rows[rowNum][col-1] = '|'
					rows[rowNum][col+1] = '|'
					timesSplit++
				}
			case '.':
				if rowNum > 0 && (rows[rowNum-1][col] == '|' || rows[rowNum-1][col] == 'S') {
					rows[rowNum][col] = '|'
				}
			}
		}
	}
	fmt.Println(timesSplit)
}

var sampleInput = `.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
...............`

var input = `......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^.....^...................................................................
.............................................................................................................................................
..................................................................^.^.^.^.^..................................................................
.............................................................................................................................................
.................................................................^.^.^.^...^.................................................................
.............................................................................................................................................
................................................................^.^.^.^...^.^................................................................
.............................................................................................................................................
...............................................................^.^.^.^.....^.^...............................................................
.............................................................................................................................................
..............................................................^...^.......^.^.^..............................................................
.............................................................................................................................................
.............................................................^.^.^.^.^.^.^...^.^.............................................................
.............................................................................................................................................
............................................................^.^.^.^...^.^.^...^.^............................................................
.............................................................................................................................................
...........................................................^.^.^.....^.^.^.^.^.^.^...........................................................
.............................................................................................................................................
..........................................................^...^.^.^...^.^...^.^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^...^.^.^...^.^.^.^.........................................................
.............................................................................................................................................
........................................................^.^.^.^.^...........^.^.^.^.^........................................................
.............................................................................................................................................
.......................................................^.......^.^.^.^.^.^.^.^.^.^.^.^.......................................................
.............................................................................................................................................
......................................................^.^...^.^.^...^.^.^...^...^.^...^......................................................
.............................................................................................................................................
.....................................................^.....^...^.^.^.^.^.^.....^.....^.^.....................................................
.............................................................................................................................................
....................................................^...^.^.^.^...^...^.^.^.^.^...^.^.^.^....................................................
.............................................................................................................................................
...................................................^.^...^.^.^...^.^...^.^.^.^.^.^.^.^...^...................................................
.............................................................................................................................................
..................................................^...^.^.^.....^.......^.^.^.^.^...^.^.^.^..................................................
.............................................................................................................................................
.................................................^.^.^.^.^.^...^.^...^.^.^.^.........^.^.^.^.................................................
.............................................................................................................................................
................................................^.^.^.^.^...^.^...^.^.^.^.^...^.^...^.^...^.^................................................
.............................................................................................................................................
...............................................^.^...^.^...........^...^.^.^.^.^...^.^.^.^...^...............................................
.............................................................................................................................................
..............................................^.......^...^.....^.^...^.^.^.^.^.^.^.^.^...^.^.^..............................................
.............................................................................................................................................
.............................................^.^...^...^...^...^.....^...^.^.^.^.^...^.^.^.^.^.^.............................................
.............................................................................................................................................
............................................^.^.^.^.^.^...^.^...^.^...^...^.^.^...^.^.^.^.....^.^............................................
.............................................................................................................................................
...........................................^.^.....^.^.^...^.^.^.^...^.^.^.^.^.....^.^.^.^.^...^.^...........................................
.............................................................................................................................................
..........................................^...^.^.^.^...^.^.^.^...^.....^...^.^.^.....^.^...^.^...^..........................................
.............................................................................................................................................
.........................................^.^...^.^.^.^.^.^.^.^.^.......^.....^.^.^.^.......^.^.^.^.^.........................................
.............................................................................................................................................
........................................^...^.^...^...^.^.^...^...^...^.^.^.^.^.^.^...^.^.^.^.^...^.^........................................
.............................................................................................................................................
.......................................^.^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.......^.^.^.^.^.^...^.^.^.^.......................................
.............................................................................................................................................
......................................^.^.^...^.^.....^.^.^...^.^.^...^.^.^...^.^...^.^.......^.....^.^......................................
.............................................................................................................................................
.....................................^.^.......^.^...^...^.^...^.^.^.^.^.....^.^.^...^.^.^...^.^.......^.....................................
.............................................................................................................................................
....................................^...^.^.......^.^.^.^.^.^.^.^.......^.^...^...^.^.^.^.^.^.^.^.^.^...^....................................
.............................................................................................................................................
...................................^.^...^.^.^.^.^.....^.^.^.^.^.^.^.....^.^.^.^.^.^.^.......^.^.^.^.^.^.^...................................
.............................................................................................................................................
..................................^.....^...^.^.....^.^...^.^.....^...^.....^.....^.^.^.^.^.......^.^.^...^..................................
.............................................................................................................................................
.................................^.....^.^.^.^.^...^.^.^...^...^...^.^.^.^.^...^.^.^.^.^.^.....^.^.^.^.^.^.^.................................
.............................................................................................................................................
................................^.^.^.^.^.^.^.^.....^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.^...^.^.^...^.....^.^.^................................
.............................................................................................................................................
...............................^...^.^...^.^.^.^.^.^.^.^.^...^.^.^.^...^.^.^.^.^.^.^...^.^...^.^.....^.^.^.^.^...............................
.............................................................................................................................................
..............................^.^.^.^.^.^.^...^.^.....^.....^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^...^...^..............................
.............................................................................................................................................
.............................^.^.^.^.^.^.^.^...^...^.^.^...^...^...^.^...^.^...^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.............................
.............................................................................................................................................
............................^.^...^.^.^.^.^.^.....^.^.^...^.....^.^...^.^...^.^.......^.^.^.^.^.^.^.^.^.^.^.^.^.^............................
.............................................................................................................................................
...........................^.^.^.^.^.^.^.....^...^.^.....^.^...^.^...^.....^.^.^...^.^.^.^.^.^.^.....^...^.^.^.^.^...........................
.............................................................................................................................................
..........................^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.....^.......^.^...^.^.^.^.^.^.^.^.........^.^.^.^...^..........................
.............................................................................................................................................
.........................^.^.^.^.^.......^.^.^.^.^.^.^...^.^.......^.^.^.....^.^.^.^.^...^.^.^.^.^.^...^.^.^.^.^...^.........................
.............................................................................................................................................
........................^.^.^.^.^.^...^...^...^.^...^...^.^.^...^...^.^.^.^.......^.....^.^...^.^.^.....^.^...^.^...^........................
.............................................................................................................................................
.......................^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^...^.....^...^...^.^.......^.^.^.....^.^.^.^...^.^.^.......................
.............................................................................................................................................
......................^...^.^.^.^.^.^.^.^...^...^.^.^.^.^...^.......^.^.....^.^.....^.^.^...^.^.^.^.^...^.^...^.^.^...^......................
.............................................................................................................................................
.....................^...^.^.^.^.^.^.^.^.....^.^.....^.^.^.^...^.^.^.^.^.^.^.....^.^...^.....^.^.....^.^.^.^...^.......^.....................
.............................................................................................................................................
....................^.^.^.^...^.....^...^.^.^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^...^.^.....^.^...^.^....................
.............................................................................................................................................
...................^.^.^.^...^...^.^.....^.^...^.^.......^.^.^.^.^.^...^.^...^.^.^.^.^...^.^.^.^...^.^.^.....^.^...^.^.^.^...................
.............................................................................................................................................
..................^.....^...^.^...^.^.^.^.^.^...^.^.^.^.^.^.^.^...^...^.^.....^.^.^.^.^.^...^.^...^.^...^.^.^.^.^.^.^...^.^..................
.............................................................................................................................................
.................^...^.^.^.^...^.^.^...^...^.^.^.^.^...^.^.^.^.^.^.^.^.....^.^.....^.^.....^...^.^.^.^.^.^...^.^.^.^.....^.^.................
.............................................................................................................................................
................^.^...^.^.^.^.^.^.^...^.^.....^...^.^.....^.^.^.^.^.........^.^.......^...^.^.^.^.^.^.......^.....^...^.^...^................
.............................................................................................................................................
...............^.^...^.^.^.^.^.^.....^.....^.^.....^.^.^.^.....^...^.^.^...^...^.^.^.^...^...^.^.^.^.^.^...^...^...^...^.^.^.^...............
.............................................................................................................................................
..............^.^.^.^...^.^.^.^.^.^.^...^...^.^.^.^.........^.^...^.....^.^.^.^.^.^.........^.^.^.^...^.^.^.^.^...^.^...^.^.^.^..............
.............................................................................................................................................
.............^.^.^.^...^.^.^.^...^.^.......^.^.^.^...^.^.........^.....^.^.^.^.^.^.^.^.^.^.^...^...^.^.^.^.^...^.^...^.^.....^.^.............
.............................................................................................................................................
............^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.....^...^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^...^.^...^.^...^.^.^...^.^.^.^.^...^.....^............
.............................................................................................................................................
...........^.^.^.^.^...^.^.^.^...^.^.^.^...^.....^.........^.^...^...^...^.^...^.^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.^.^.^.^.^.^.^...........
.............................................................................................................................................
..........^.^.^.^...^...^.^...^...^.^.^...^.^.^.^.^.^...^.^...^...^.........^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^...^...^.^.^...^...^.^..........
.............................................................................................................................................
.........^.^.^...^.^...^...^...^.^.^...^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.......^.^.^.^...^.^.^.^.^.^...^...^.........
.............................................................................................................................................
........^.^.^.^.^.....^.^.^.^.^.^.^.^...^.^.^.^.^.....^.^.^.^.^.^...^.^.^.^...^.....^.^...^.^.^...^.^.^.^...^.^.^.....^.^.^.^.^...^.^........
.............................................................................................................................................
.......^.^.^.^.^.^...^.^...^.^...^.....^.^...^.^...^.^...^.^.^.^.^.^...^...^.^.^.^.^.^.....^.^.^...^.^.^.^...^...^...^.^.^.^.^...^.^.^.......
.............................................................................................................................................
......^.^.^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.^...^.^...^...^.^.^.....^.........^.^.^.^.^.^.^.^.^.^.....^.^...^...^.^.^.^.^.^.^.^.^.....^......
.............................................................................................................................................
.....^...^...^.^.^.^.^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.^.^.....^...^.^.^.....^.^.^.^.^.^.^.^.^.....^...^.^.^.^.^.^...^.^.^.^.....^.^.^.....
.............................................................................................................................................
....^.^.^.^.^...^.^.....^.^...^...^.^.^.^.^...^.^.^.^.^.....^.^.^.^...^.^...^...^.^.^.^...^.^.....^.^.^.^.....^.^.^...^.......^.^.^.^...^....
.............................................................................................................................................
...^.^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.....^.^.^...^.^...^.....^.^.^.^.^.^.^.^.^...^...^.^.^.^...^.^...^.^...^.^...^.^.^.^.^...
.............................................................................................................................................
..^.^.^...^.^.....^.^.^...^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^...^.^.^.^.^.....^.....^.^.^.^.....^...^...^.^.^.....^.^.^.^.^.^...^...^.^..
.............................................................................................................................................
.^.^.^.^.^...^.^.^.^.^.^.^.^.^.....^.....^.^...^.^.^.^.^...^.^...^.^.^...^.^...^...^.^.^.^.^.^...^.^.^...^.^...^.^.^.^...^.^...^.^.^.^.^.^.^.
.............................................................................................................................................`
