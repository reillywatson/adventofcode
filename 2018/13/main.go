package main

import (
	"fmt"
	"sort"
	"strings"
	"time"
)

type dir byte

const (
	up       dir = '^'
	down     dir = 'v'
	left     dir = '<'
	right    dir = '>'
	straight dir = ' '
)

var newDir = map[byte]map[dir]dir{
	'|':  {up: up, down: down, left: left, right: right},
	'+':  {up: up, down: down, left: left, right: right},
	'-':  {up: up, down: down, left: left, right: right},
	'/':  {up: right, down: left, left: down, right: up},
	'\\': {up: left, down: right, left: up, right: down},
}

type cart struct {
	x        int
	y        int
	dir      dir
	lastTurn dir
}

func main() {
	var carts []*cart
	var width int
	var emptyGrid [][]byte
	for y, line := range strings.Split(input, "\n") {
		width = len(line)
		for x, r := range line {
			d := dir(r)
			switch d {
			case up, down, left, right:
				carts = append(carts, &cart{x: x, y: y, dir: d, lastTurn: right})
			}
		}
		line = strings.Replace(line, "<", "-", -1)
		line = strings.Replace(line, ">", "-", -1)
		line = strings.Replace(line, "v", "|", -1)
		line = strings.Replace(line, "^", "|", -1)
		emptyGrid = append(emptyGrid, []byte(line))
	}

	for _, l := range emptyGrid {
		fmt.Println(string(l))
	}
	fmt.Println(input)
	ticks := 0
	for ; ; ticks++ {
		if ticks%1000 == 0 {
			fmt.Println(ticks)
		}
		grid := [][]byte{}
		for _, line := range emptyGrid {
			grid = append(grid, []byte(string(line)))
		}
		sort.Slice(carts, func(i, j int) bool { return carts[i].y*width+carts[i].x < carts[j].y*width+carts[j].x })
		for i := range carts {
			grid[carts[i].y][carts[i].x] = emptyGrid[carts[i].y][carts[i].x]
			switch carts[i].dir {
			case up:
				carts[i].y--
			case down:
				carts[i].y++
			case left:
				carts[i].x--
			case right:
				carts[i].x++
			default:
				panic(string(carts[i].dir))
			}
			switch dir(grid[carts[i].y][carts[i].x]) {
			case up, down, left, right:
				// crash!
				fmt.Println(carts[i].x, carts[i].y, ticks)
				return
			case '+':
				switch carts[i].lastTurn {
				case left:
					carts[i].lastTurn = straight
				case straight:
					carts[i].dir = newDir['/'][carts[i].dir]
					carts[i].lastTurn = right
				case right:
					carts[i].dir = newDir['\\'][carts[i].dir]
					carts[i].lastTurn = left
				}
			default:
				carts[i].dir = newDir[grid[carts[i].y][carts[i].x]][carts[i].dir]
			}
			grid[carts[i].y][carts[i].x] = byte(carts[i].dir)
		}
		for _, line := range grid {
			fmt.Println(string(line))
		}
		time.Sleep(time.Millisecond * 20)
		_ = time.Sleep
	}
}

var input3 = `|
v
|
|
|
^
|`

var input2 = `/->-\        
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/   `

var input = `                                           /-----------------------------------------------------------------\                                        
  /----------------------\/----------------+-------------------------------------------------------\    /----+----\                                   
  |                      ||                |   /----------------------------\                      |    | /--+----+---------------------------------\ 
 /+----------\    /------++----------------+---+-----------\                |   /------------------+----+-+--+----+---------------------------\     | 
 ||          |    |/-----++----------------+---+-----------+--------\       |   |                  |    | |  |    |                           |     | 
 ||          |    ||     ||                |   |    /------+-------\|       |   |            /-----+----+\|  |    |                  /--------+----\| 
 ||          |    ||     ||         /------+---+----+------+-------++-------+---+------------+-----+----+++--+----+\                 |        |    || 
 ||     /----+----++--\  ||         |      |   |    |      |       ||     /-+---+------------+-----+----+++--+----++------\          |        |    || 
 ||     |    |    ||  |  ||         |      |   |    |      |       ||     | |   |            |     |    |||  |    ||      |          |        |    || 
 ||     |    |    ||  |  ||     /---+------+---+----+------+-------++-----+-+---+------------+-----+----+++--+----++------+-----\    |        |    || 
 ||     |    |    ||  | /++-----+---+--\   |   |    |      |       ||     | |   |            |     |    |||  |    ||      |     |    |        |    || 
 ||     |    |    ||  | |||     |   |  |   \---+----+------+-------++-----+-+---+------------+-----+----+++--/    ||      |     |    |        |    || 
 ||  /--+----+----++--+-+++-----+---+--+-------+----+------+------\||     | |   |         /--+-----+----+++-------++------+-----+----+--------+--\ || 
 ||  |  |    |    ||  | |||     |   |  v       |    |      |      |||     | |   |         |  |     |    |||       ||      |     |    |        |  | || 
 ||  |  |/---+----++--+-+++-----+---+--+-------+----+------+------+++----\| |   |         |  |     |    |||       ||      |     |    \--------+--+-/| 
 \+--+--++---/    |\--+-+++-----+---+--+-------+----+------+------++/ /--++-+---+---------+--+---\ |    |||       ||      |     |             |  |  | 
  |  |  ||        |   | |||     |   |  |       |    |   /--+------++--+--++-+---+------\  |  |   | |    |||       ||      |     |             |  |  | 
  |  |  ||        |/--+-+++-----+---+--+-------+----+---+--+---\  ||  |  || |   |      |  |  |   | |    |||       ||      |   /-+-------------+\ |  | 
  |/-+--++--------++--+-+++-----+---+--+-------+----+---+--+--\|  ||  |  || |   |      |  |  |   | |    |||       ||      |   | |             || |  | 
  || |  ||        ||  | |||     |   |  |       |    \---+--+--++--+/  |  || |   \------+--+--+---+-+----+++-------++------+---+-+-------------/| |  | 
  || |  ||        ||  | |||/----+---+--+-------+--------+--+--++--+---+--++-+--->------+--+--+---+-+----+++-------++------+---+-+--\           | |  | 
  || |  ||        ||  | ||||    \---+--+-------+--------+--+--++--+---+--++-+----------+--+--+---+-+----+++-------++------+---+-/  |           | |  | 
  || |  ||        ||  | ||||        |  |   /--<+----\   |  |  ||  |   |  |\-+----------+--+--+---+-+----+++-------++------/   |    |           | |  | 
  || |  \+--------++--/ ||||        |  |   |  /+----+---+--+--++--+---+\ |  |          |  |  |   | |    |||       ||          |    |           | |  | 
  || |   |/-------++----++++--------+--+---+--++---\|   |/-+--++--+---++-+--+--------\ | /+--+---+-+----+++-------++----------+----+-----\     | |  | 
  || |   ||       ||    ||||        |  |   |  ||   ||/--++-+--++--+---++-+--+--------+-+-++--+---+-+----+++-------++----------+----+-----+-----+-+--+\
  || |   ||       ||    ||||        |  |   |  ||   |||  || |  ^|  |   || |  |        | | ||  |   | |    |||       ||          |    |     |     | |  ||
  || |   ||       ||    ||||       /+--+---+--++---+++--++-+--++--+---++-+--+--------+-+-++--+---+-+----+++-------++----------+----+-----+---\ | |  ||
  || |   ||       ||    ||||   /---++--+---+--++---+++--++-+--++--+---++-+--+--------+-+-++--+---+-+----+++------\||          \----+-----+---+-/ |  ||
  || |   ||       ||    ||||   |/--++--+---+--++---+++--++-+--++--+---++-+--+--------+-+-++--+---+-+----+++------+++---------------+---\ |   |   |  ||
  || |   ||       ||    ||||   ||  || /+---+--++---+++--++-+--++--+---++-+--+--------+-+-++--+---+-+----+++------+++---------------+---+-+---+-\ |  ||
  \+-+---++-------++----+/||   ||  || ||   |  ||   |||  || |  ||  |   || |  |        | | ||  | /-+-+----+++------+++---------\     |   | |   | | |  ||
   | |   ||     /-++----+-++---++--++-++---+--++---+++--++-+--++--+---++-+--+--------+-+-++--+-+-+-+\   |||      |||         |     |   | |   | | |  ||
   | |   ||/----+-++----+-++---++--++-++---+--++---+++--++-+--++--+---++-+--+--------+-+-++--+-+-+-++---+++----\ |||         |     |   | |   | | |  ||
   | |   |||    | ||    | ||   ||  || ||   |  ||   |||  || |  ||  |   || |  |   /----+-+-++--+-+-+-++---+++----+-+++--\      |     |   | |   | | |  ||
   | |   |||    | ||    | ||   ||  || ||   |  |\---+++--++-+--++--+---++-+--/   | /--+-+-++-\| | | ||   |||    | |||  |      |     |   | |   | | |  ||
   | |   |||    | ||    | ||   ||  || ||   |  |    |||  || |/-++--+---++-+------+-+--+-+-++-++-+-+-++---+++----+-+++--+------+-----+---+-+\  | | |  ||
   | |   |||    | ||   /+-++---++--++-++---+--+----+++--++-++-++--+---++-+------+-+--+-+-++-++-+-+-++---+++-\  | |||  |      |     |   | ||  | | |  ||
  /+-+---+++----+-++---++-++---++--++-++---+--+-\  |||  || || ||  |   || |      | |  | | || || | | ||   ||| |  | |||  |      |     |   | ||  | | |  ||
  || |   |||    | ||   || ||   ||  || ||   |  | |  |||  || || ||  ^  /++-+------+-+--+-+-++-++-+-+-++--\||| |  | |||  |      |     |   | ||  | | |  ||
  || |   |||    | ||   || ||   ||  || ||/--+--+-+--+++--++-++-++--+--+++-+------+-+--+-+-++-++-+-+-++--++++-+-\| |||  |      |     |   | ||  | | |  ||
  || |   |||    | ||   || ||   ||  || |||  |/-+-+--+++--++-++-++--+--+++-+------+-+--+-+-++-++-+-+-++--++++-+-++-+++--+------+-----+---+-++-\| | |  ||
  || |   |||    | ||   || ||   ||  || |||  || | |  |||  |\-++-++--+--+++-+------+-+--/ | || || | | ||  |||| | || |||  |      |     |   | || || | |  ||
  || |   |||    | ||   || ||/--++--++-+++--++-+-+--+++--+--++-++--+--+++-+------+-+---\| || || | |/++--++++-+-++-+++--+------+---\ | /-+-++-++-+-+-\||
  || |   |\+----+-++---++-+++--++--++-+++--++-+-+--/|| /+--++-++--+--+++-+------+-+--\|| || || | ||||  |||| | || |||  |      |   | | | | || || | | |||
/-++-+---+-+----+-++---++-+++--++--++-+++--++-+-+---++-++--++-++--+--+++-+------+-+--+++-++-++-+-++++-\|||| | || |||  |      |   | | | | || || | | |||
| || |   | |    | \+---++-+++--++--++-+++--++-+-+---++-++--/| ||  |  ||| |      | |  ||| || || | |||| ||||| | || |||  |      |   | | | | || || | | |||
| || |   | |    |  \---++-+++--++--++-+++--++-+-+---++-++---+-+/  |  ||| |      | |  ||| || || | |||| ||||| | || |||  |      |   | | | | || || | | |||
| || |   | |   /+------++-+++--++--++-+++--++-+-+---++-++---+-+--\|  |\+-+------+-+--+++-++-++-+-/||| ||||| | || |||  |      |   | | | | || || | | |||
| || |   | |   ||      || |||  ||  || |||  || | |   || ||   | |  ||  | | |      | |  ||| || |\-+--+++-+++/| | || |||  |      |   | | | | || || | | |||
| || |   | |   ||      || |||  ||  || |||  || | |   || ||   | |  ||  | | |      | |  ||| || |  |  ||| ||| | | || |||  |   /--+---+-+-+-+-++\|| | | |||
| || |   | |   ||  /---++-+++--++--++-+++--++-+-+---++-++---+-+--++\ | | |     /+-+--+++\|| |  |  ||| ||| | | || |||  |/--+--+---+\| | | ||||| | | |||
| || |   | |   ||  |   || |||  ||  || ||| /++-+-+---++-++---+-+--+++-+-+-+-----++-+--++++++-+--+--+++-+++-+-+-++-+++--++--+--+\  ||| | | ||||| | | |||
| || |   | |   ||  |   || |||  ||/-++-+++-+++-+-+---++-++---+-+--+++-+-+-+-----++-+\ |||||| |  |  ||| ||| \-+-++-+++--++--+--++--+++-+-+-+++++-+-+-+/|
| || |/--+-+---++--+---++-+++--+++-++-+++-+++-+-+---++-++---+-+--+++-+-+-+-----++-++-++++++-+-\|  ||| |||   | || |||  ||  |  ||  ||| | | ||||| | | | |
| || ||  | |   || /+---++-+++--+++-++-+++-+++-+-+---++-++---+-+--+++-+-+-+-----++-++-++++++-+-++--+++-+++-\ | || |||  ||  |  ||  ||| | | ||||| | | | |
| || ||  | |   || ||   ||/+++--+++-++-+++-+++-+-+---++-++---+-+>-+++-+-+-+-----++-++-++++++-+-++--+++-+++-+-+-++-+++--++--+--++\ ||| | | ||||| | | | |
| || ||  | |   || ||   ||||||  ||| || ||| |\+-+-+---/| ||   | |  ||| | | |     || || |||||| | ||  ||| ||| | | || |||  ||  |  ||| ||| | | ||||| | | | |
| || ||  | |   || ||   ||||||  |\+-++-+++-+-+-+-+----+-++---+-+--+++-+-+-+-----++-++-++++++-+-++--+++-+++-+-+-++-+++--++--+--+++-+++-+-/ ||||| | | | |
| || ||  | |   || ||   ||||||  | | || ||| | | | |    | ||   | |  ||| | | |     || || ||||||/+-++--+++-+++-+-+-++-+++--++\ |  ||| ||| |   ||||| | | | |
| || ||  | |   || ||   ||||\+--+-+-++-+++-+-+-+-+----+-++---+-+--+++-+-+-+---->++-++-++++++++-++--+++-+++-+-+-++-+++--+++-+--+++-++/ |   ||||| | | | |
| || ||  | \---++-++---++++-+--+-+-++-+++-+-+-+-+----+-++---+-+--+++-+-+-+-----++-++-++++++++-++--+++-+++-+-+-+/ |||  ||| |  ||| ||  |   ||||| | | | |
| || ||  | /---++-++\  |||| |  | | || ||| | | | |    |/++---+-+--+++-+-+-+-----++-++-++++++++-++--+++-+++-+-+-+--+++--+++-+--+++-++--+---+++++\| | | |
| || ||  | |   || |\+--++++-+--+-+-++-+++-+-+-+-+----++++---+-+--++/ | | |     || || |||||||| ||  ||| ||| | | |  |||  ||| |  ||| ||  |   ||||||| | | |
| || ||  | |   || | |  |||| |  | | || ||| \-+-+-+----++++---+-+--++--+-+-+-----++-++-++++++++-++--+++-+++-+-+-+--+++--+++-+--+/| ||  |   ||||||| | | |
| || ||  | |   || | |  |||\-+--+-+-++-+++---+-+-+----++++---+-+--++--+-+-+-----++-++-++++++++-++--+/| ||| | v |  |||  ||| |  | | ||  |   ||||||| | | |
| || ||  | |   || | |  |||  |/-+-+-++-+++---+-+-+----++++---+-+--++--+\| |     || || |||||||| ||  | | ||| | | |  |||  ||| |  | | ||  |   ||||||| | | |
| || ||  | |   || | |  ||| /++-+-+-++-+++---+-+-+----++++---+-+\ ||  ||| | /---++-++-++++++++-++--+-+-+++-+-+\|  |||  ||| |  | | ||  |   ||||||| | | |
| ||/++--+-+---++-+-+--+++-+++-+-+-++-+++---+-+-+----++++--\| || ||  ||| | |   || || |||||||| ||  | | ||| | |||  |||  ||| |  | | ||  |   ||||||| | | |
| |||||  | |   |\-+-+--+++-+++-+-+-++-+++---+-+-+----++++--++-++-++--+++-+-+---++-++-++++++++-++--+-/ ||| | |||  |||  ||| |  | | ||  |   ||||||| | | |
| |||||  | |   |  | |  ||| ||| | | || |||   | | |    ||||  || || ||  ||| | |   || || ||||\+++-++--+---+++-+-+++--+++--+++-+--+-+-++--+---/|||||| | | |
| |||||  | |   |  | |  ||| ||| | | || |||   | | |    ||\+--++-++-++--+++-+-+---++-++-/||| ||| |\--+---+++-+-+++--+++--+++-+--/ | ||  |    |||||| | | |
| |||||  | |   | /+-+--+++-+++-+-+-++-+++---+-+-+----++-+-\|| || ||  ||| | |   || ||  ||| ||| |   |   ||| | |||  |||  ||| |    | ||  |    |||||| | | |
| |||||  | |   | || |  ||| ||| | | || |||   | | |    || | ||| || ||  ||| | |   || ||  ||| ||| | /-+---+++-+-+++--+++--+++-+----+-++\ \----++++++-+-/ |
| |||||  | |   | || |  ||| ||| | | || |||   | | |    || | ||| || ||  ||| | |   || ||  ||| \++-+-+-+---+++-+-+++--+++--+++-+----+-+++------++++++-/   |
| |||||  | |   | || |  ||| ||| | | || |||   | \-+----++-+-+++-++-++--++/ | |   || ||  |||  || | | |   ||| | |||  |||  ||| |    | |||      ||||||     |
| |||||  | |   | || |  ||| ||| | | || |||   |   |    || | ||| || ||  ||  | |   || ||  |||  || | | |   ||| | |||  |||  ||| |    | |||      ||||||     |
| |||||  | |   | || |  ||| |v| | | || |||  /+---+----++-+-+++-++-++--++--+-+---++-++--+++--++-+-+-+---+++-+-+++--+++--+++-+\   | |||      ||||||     |
| |||||  \-+---+-++-+--+++-+++-+-+-++-+++--++---+----++-+-+++-++-++--++--/ |   || ||  |||  || | | |   ||| | |||  |||  ||| ||   | |||      ||||||     |
| |||||    |   | || |  ||| ||| | | || |||  |\---+----++-+-+++-++-++--++----+---++-++--+++--++-+-+-+---+++-+-+++--+++--+++-++---+-+++------++/|||     |
| |||||    |   | || |  ||| ||| | | || |||  |    |    || | ||| || ||  ||/---+---++-++--+++--++\| | |   ||| | |||  |||  ||| ||   | |||      || |||     |
\-+++++----+---+-++-+--+++-+++-+-+-++-+++--+----+----++-+-+++-++-++--+++---+---++-++--+++--++++-+-+---/|| | |||/-+++--+++-++---+-+++------++-+++\    |
  |||||    |   | || |  ||| |||/+-+-++-+++--+----+--\ || | ||| || ||  |||   |   |\-++--+++--++++-+-+----++-+-++++-+++--/|| ||   | |||      || ||||    |
  |||\+----+---+-++-+--+++-+++++-+-++-+++--+----+--+-++-+-+++-++-+/  |||   |   |  ||  |||  |||| | |    || | |||| |||   || ||   | |||      || ||||    |
  ||| |    |   | || | /+++-+++++-+-++-+++--+----+--+-++-+-+++-++-+---+++---+---+-\||  |||  |||| | |    || | |||| |||   || ||   | |||      || ||||    |
  ||| |    |   | || | |||| ||||| | || |||  |    |/-+-++-+-+++-++-+---+++---+---+-+++--+++--++++-+-+----++-+-++++-+++---++-++--\| |||      || ||||    |
  ||| |    \---+-++-/ ||\+-+++++-+-++-+/|  |    || | |\-+-+++-++-+---+++---+---+-+++--+++--++++-+-+----++-+-++++-+++---++-++--++-+++------++-+/||    |
/-+++-+--------+-++-\ || | ||||| | || | |  |    || |/+--+-+++-++-+---+++---+<--+\|||/-+++--++++-+-+----++-+-++++-+++---++-++--++-+++\     || | ||    |
| ||| |        | || | || | ||||| | |\-+-+--+----++-+++--+-+++-++-+---+++---+---++++++-+++--++++-+-+----++-+-++++-++/   || ||  || ||||     || | ||    |
| ||| |        | || | || | ||\++-+-+--+-+--+----++-+++--+-+++-++-+---+/|   |   |||||| |||  |||| | |    || | |||| ||    || ||  || ||||     || | ||    |
| ||| |        | || | || | || |\-+-+--+-+--+----++-+++--+-+++-++-+---+-+---+---++++++-+++--++++-+-+----++-+-++++-/|    || ||  || ||||     || | ||    |
| ||| |        | || | || | || |  | |  | |  |    || ||| /+-+++-++-+---+-+---+---++++++-+++--++++-+-+--\ || | ||||  |    || ||  || ||||     || | ||    |
| ||| |        | || | || \-++-+--+-+--+-+--+----++-+++-++-+++-++-+---+-+---+---++++++-+++--++++-+-+--+-++-+-++++--+----++-++--+/ ||||     || | ||    |
| ||| |        | || | ||   || |  | |  | |  |    || ||\-++-+++-++-+---+-+---+---++++++-+++--++++-+-+--+-++-+-++++--+----++-++--+--++++-->--++-+-++----/
|/+++-+-------\| || | ||   || |  | \--+-+--+----++-++--++-+++-++-+---+-+---+---++++++-+++--++++-+-+--+-++-+-++++--+----++-++--+--++++-----++-/ ||     
||||| |       || |\-+-++---++-+--+----+-+--+----++-++--++-+++-++-+---+-+---+---++++++-+++--++++-+-+--+-++-/ ||||  |    || ||  |  ||||     ||   ||     
||||| |       || |  | ||   || |  |    | |  |    || ||  || ||| || |   | |   |   |||||| |||  |||| | |  | ||   ||||  |    || ||  |  ||||     ||   ||     
||||| |       || |  | ||   || |  |    | |  |    || ||  || ||| || |   | \---+---++++++-+++--++/| | |  | ||   ||||  |    || ||  |  ||||     ||   ||     
||||| |       || |  | ||   || |  | /--+-+>-+----++-++--++-+++-++-+---+-----+---++++++-+++--++-+-+-+--+-++---++++--+----++-++--+--++++---\ ||   ||     
||||| |       || |  | ||   || |  | |/-+-+--+----++\||  || ||| || |   |     |   |||||| |||  || | | |  | ||/--++++<-+----++-++--+--++++---+-++---++---\ 
||||| |       || |  | ||   || | /+-++-+-+--+----+++++--++-+++-++-+---+-----+---++++++\|||  || | | |  | |||  ||||  |    || ||  |  ||||   | ||   ||   | 
||||| |       || | /+-++---++-+-++-++-+-+--+-\  |||||  || ||| || |   |     |   ||||||||||  || | | |  | |||  ||||  |    ||/++--+--++++---+-++--\||   | 
||||| |       || | || ||/--++-+-++\|| |/+--+-+--+++++--++-+++-++-+---+-\   |   ||||||||||  || | | |  | |||  ||||  |    |||||  |  ||||   | ||  |||   | 
||||| |       || | || |\+--++-+-+++++-+++--+-+--+++++--++-+++-++-+---+-+---+---++++++++++--++-+-+-+--+-+++--/|||  |    |||||  |  ||||   | |^  |||   | 
|||\+-+-------++-+-++-+-+--++-+-+++++-+++--+-+--+++++--++-+++-/| |   | |   |/--++++++++++--++-+-+-+--+-+++---+++--+----+++++--+--++++---+-++-\|||   | 
||| | |       || | || | |  ||/+-+++++-+++--+-+--+++++--++-+++--+-+---+-+---++--++++++++++\ || | | |  | |||   ||\--+----+++++--+--++++---+-++-+++/   | 
||| | |       || | || | |  |||| ||||| \++--+-+--+++++--++-+++--+-+---+-+---++--+++++++++++-++-+-+-+--+-+++---++---+----+++++--+--++++---+-++-++/    | 
||| | |       || | || | |  |||| |||||  ||  | |  |||||  |\-+++--+-+---+-+---++--++++++++/|| || | |/+--+-+++---++---+----+++++--+--++++-\ | || ||     | 
||| | |       || | || | |  |||| |||||  ||  | |  |||||  |  |||  | |   | |   ||  |||||||| || || | |||  | |\+---++---/    |||||  |  |||| | | || ||     | 
||| | |       || | || | |  |||| |||||  ||  | |  |||||  |  |||  | |   | |   ||  |||||||| || || | |||  | | |   ||        \++++--+--+/|| | | || ||     | 
||| | |       || | || | |  |||| |||||  |\--+-+--+++++--+--+++--+-+---+-+---++--++++++++-++-++-+-+++--+-+-+---+/         ||||  |  | || | | || ||     | 
||| | |       || | || | |  |||| |||||  |   v |  ||||\--+--+++--+-+---+-+---++--+/|||||| || || | ||\--+-+-+---+----------++++--+--/ || | | || ||     | 
||| | |       || | || | |  |||| |||||  |   | |  ||||   |  |||  | |   | |   ||  | |||||| || || | ||   | | |/--+-----\    ||\+--+----++-+-+-+/ ||     | 
||| | |       || | || | |  |||\-+++++--+---+-+--+++/   |  |||  | |   | |   ||  | |||||| || || | ||   | | ||  |     |    || |  |    || | | |  ||     | 
||| | |       || | || | |  |||  |||||  |   | |  |||    |  |||  | |   | |   ||  | |||\++-++-++-+-++---+-+-++--+-----+----++-+--+----+/ | | |  ||     | 
||| | |       || | || | |  |||  ||||| /+---+-+--+++----+--+++--+-+---+-+---++-\| ||| || || || | ||   | | ||  |     |    || |  |    |  | | |  ||     | 
||| | |       || | || | |  ||\--+++++-++---+-+--+++----+--+++--+-+---+-+---++-++-+++-++-+/ || | |\---+-+-++--+-----+----++-+--+----+--/ | |  ||     | 
||| | |       || | || | |  ||   |\+++-++---+-+--+++----+--+++--+-+---+-+---++-++-++/ || |  || | |    | | ||  |     |    || |  |    |    | |  ||     | 
||| | \-------++-+-++-+-+--++---+-+++-++---+-+--+++----+--+++--+-+---+-+---++-++-++--++-+--++-/ |    | | ||  |     |    |\-+--+----+----+-+--+/     | 
||| |         |\-+-++-+-+--++---+-+++-++---+-+--+++----+--+++--+-/   | |   || || |\--++-+--+/   |    | | ||  |     |    |  |  |    |    | |  |      | 
||| |         |  | || | |  ||   | ||| ||   | |  |||    |  |||  |     | |   || || |   || |  \----+----+-+-++--+-----+----/  |  |    |    | |  |      | 
||| |         |  | || | |  ||   | ||| ||   | |  |||    |  |||  |     | |   || || |   || |      /+----+-+-++--+-----+-------+--+----+--\ | |  |      | 
||| |  /------+--+-++-+-+--++---+-+++-++---+-+--+++----+--+++--+-----+-+---++-++-+---++-+------++----+-+-++--+-\   |       |  |    |  | | |  |      | 
||| |  |      |  | || | |  |\---+-+++-++---+-+--+++----+--+++--+-----+-+---++-++-+---+/ |      ||    | | ||  | |   |       |  |    |  | | |  |      | 
||| |  |      |  | || | |  |    | ||| ||   | |  |||    |  |||  |     | |   || || |   |  |      ||    | | \+--+-+---+-------+--+----+--+-+-+--+------/ 
||| |  |      |  | || | |  |    | ||| ||   | |  |||    |  |||  |     | |   || || |   |  |      ||    | |  |  | |   |       |  |    |  | | |  |        
||| |  |      |  | || | |  |    | ||| ||   | |  |||    |  |||  |     \-+---++-++-+---+--+------++----+-/  |  | |   |       |  |    |  | | |  |        
||| |  |      |  | || | |  |    | ||| ||   | |  |||    |  |||  |       |   || || |   |  |      |\----+<---+--+-+---+-------+--+----/  | | |  |        
|\+-+--+------/  | || | |  |    | ||| ||   | |  |||    |  |||  |       |   || || | /-+--+------+-----+----+\ | |   |       |  |       | | |  |        
| | |  |         | || | |  |    | ||| ||   | |  |||    |  |||  |       |   || || | | |  |      |     |    || | |   |       |  |       | | |  |        
| | |  |         | || | |  |    | ||| ||   | |  |||    |  |||  |       |   |\-++-+-+-+--+------+-----+----++-+-+---+-------+--+-------+-+-+--/        
| | |  |         | || | |  |    | ||| ||   | |  |||    \--+++--+-------+---+--++-+-+-+--+------+-----/    || | |   |       |  |       | | |           
| | |  |         | || | |  \----+-+++-++---+-+--+++-------+++--/       |   \--++-+-+-+--+------+----------++-/ |   |       |  |       | | |           
\-+-+--+---------+-+/ | |       | |\+-++---+-+--+++-------+++----------+------++-+-+-+--+------+----------++---+---+-------+--+-------+-/ |           
  | |  |         | |  | \-------+-/ | |\---+-+--+++-------+++----------/      || | | |  |      \----------++---+---+-------+--+-------/   |           
  | |  |         | |  |         |   | \----+-+--+++-------+++-----------------/| | | |  |                 ||   |   |      /+--+---------\ |           
  | |  |         | \--+---------+---+------+-//-+++-------+++------------------+-+-+-+--+-----------------++---+---+------++--+---------+\|           
  | |  |         |    |         |   |      |  | |||       |||                  | | | |  |                 ||   |   |      ||  |         |||           
  | \--+---------+----+---------+---+------+--+-+++-------+/|                  | | | |  |                 \+---+---/      ||  |         |||           
  |    |         |    |         |   |      |  | |v|       | |                  | | | |  |                  |   |          ||  |         |||           
  |    |         \----+---------+---+------+--+-+++-------/ |                  | | | |  |                  |   |          ||  |         |||           
  |    |              |         |   |      \--+-+++---------+------------------+-+-+-+--+------------------+---+----------+/  |         |||           
  |    |              |         |   |         | |\+---------+------------------+-+-+-+--+------------------+---+----------+---/         |||           
  |    |              |         |   \---------+-+-/         \------------------+-+-+-+--+------------------+---+----------+-------------++/           
  |    |              |         \-------------+-+------------------------------+-+-+-/  |                  |   |          |             ||            
  \----+--------------+-----------------------+-/                              | | \----+------------------/   |          |             ||            
       \--------------+-----------------------+--------------------------------+-+------+----------------------/          |             ||            
                      \-----------------------+--------------------------------+-/      |                                 |             ||            
                                              \--------------------------------+--------+---------------------------------+-------------+/            
                                                                               \--------/                                 \-------------/             `
